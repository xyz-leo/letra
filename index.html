<!-- Filename: index.html-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Letra ‚Äî Jogo de palavras offline</title>

  <!-- Cool trick -->
  <link rel="icon" href="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='64' height='64' viewBox='0 0 64 64'><rect width='64' height='64' fill='%230052cc' rx='12' ry='12'/><text x='32' y='42' font-family='Segoe UI, Tahoma, Geneva, Verdana, sans-serif' font-size='36' fill='white' font-weight='bold' text-anchor='middle' dominant-baseline='middle'>L</text></svg>" type="image/svg+xml" />

  <style>
    /* github.com/xyz-leo */

    /* Light mode color variables */
    :root {
      /* Body will be dark as default */
      --color-bg: #121212;
      --color-text: #f1f1f1;
      --color-subtle: #aaaaaa;
      --color-border: #333333;
      --color-tile: #1e1e1e;

      --color-accent: #3ecf8e;       /* Accent color */
      --color-correct: #4caf50;      /* Correct letter tile color */
      --color-wrong-spot: #c9b458;   /* Letter in wrong position tile color */
      --color-incorrect: #b0b0b0;    /* Incorrect letter tile color */
    }

    /* Light theme configuration */
    body.light {
      --color-bg: #f9f9f9;           /* Main background */
      --color-text: #1a1a1a;         /* Default text color */
      --color-subtle: #6e6e6e;       /* Secondary text color */
      --color-border: #999999;       /* Borders and light lines */
      --color-tile: #e0e0e0;         /* Tile background (game squares) */
    }

    /* Reset default spacing and use border-box sizing */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* Base font size and smooth scrolling */
    html {
      font-size: 62.5%; /* 1rem = 10px */
      scroll-behavior: smooth;
    }

    /* Body layout and theming */
    body {
      display: flex;
      flex-direction: column;
      background-color: var(--color-bg);
      color: var(--color-text);
      font-family: sans-serif;
      font-size: 1.6rem; /* 16px */
      line-height: 1.5;
      transition: background-color 0.3s ease, color 0.3s ease;
      -webkit-font-smoothing: antialiased;
      min-height: 100vh;
      width: 100%;
    }

    /* Headings inherit font weight and color */
    h1, h2, h3, h4, h5, h6 {
      font-weight: 600;
      line-height: 1.2;
      color: inherit;
    }

    /* Links inherit color, no underline */
    a {
      color: inherit;
      text-decoration: none;
    }

    /* Remove default list styles */
    ul, ol {
      list-style: none;
    }

    /* Responsive media */
    img, picture, video, canvas, svg {
      max-width: 100%;
      display: block;
    }

    /* Form elements inherit font and remove borders */
    button, input, textarea, select {
      font: inherit;
      color: inherit;
      background: none;
      border: none;
      outline: none;
    }

    /* Remove number input spinner buttons on WebKit browsers */
    input[type="number"]::-webkit-inner-spin-button,
    input[type="number"]::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    /* --- Header --- */

    /* Header grid layout */
    header {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      align-items: center;
      padding: 2rem 10rem;
    }
    
    /* Left button group */
    .left-buttons {
      justify-self: start;
      display: flex;
      gap: 1rem;
    }

    /* Right button group */
    .right-buttons {
      justify-self: end;
      display: flex;
      gap: 1rem;
    }

    /* Center app name styling */
    .app-name {
      font-size: clamp(1.4rem, 3vw, 2rem);
      justify-self: center;
      text-align: center;
    }

    /* Buttons in header larger for better tap targets */
    .left-buttons button,
    .right-buttons button {
      font-size: 3rem;
      border: solid 3px var(--color-text);
      border-radius: 1rem;
      padding: 0 1rem;
    }

    .left-buttons button:hover, 
    .right-buttons button:hover {
      cursor: pointer;
      transform: translateY(-5px);
      transition: 0.5s ease;
    }

    /* Configuration button dropdown menu */
    .config-dropdown {
      position: absolute;
      top: 8rem;
      right: 3rem;
      background-color: var(--color-tile);
      border: 2px solid var(--color-border);
      border-radius: 1rem;
      padding: 1rem;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
      z-index: 100;
      width: max-content;
    }

    .config-dropdown li {
      padding: 0.5rem 1rem;
      cursor: pointer;
      white-space: nowrap;
    }

    .config-dropdown li:hover {
      background-color: var(--color-accent);
      color: #fff;
      border-radius: 0.5rem;
      transition: 0.5s ease;
    }

    /* Informative message */
    .msgBox {
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 1rem;
      margin: 0 auto;
      margin-bottom: 1rem;
      padding: 1rem 5rem;
      background-color: var(--color-accent);
      font-size: 1.8rem;
      transition: opacity 0.6s ease-in-out;
      z-index: 1000;
      pointer-events: none;
      opacity: 0;
    }

    #msgBox.show {
      opacity: 1;
    }

    /* --- Modal ---*/
    /* Modal Overlay */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0, 0, 0, 0.6); /* semi transparent background */
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 999;
      backdrop-filter: blur(4px); /* background with blur */
    }

    /* Modal Content Box */
    .modal-content {
      position: relative;
      background: #1e1e1e;
      color: #f9f9f9;
      font-size: 1.6rem;
      padding: 3rem 4rem;
      line-height: 2.8rem;
      border-radius: 16px;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.4);
      width: 90%;
      max-width: 500px;
      max-height: 80vh;
      overflow-y: auto;
      animation: fadeInScale 0.3s ease-out;
    }

    /* Smooth opening animation */
    @keyframes fadeInScale {
      from {
        opacity: 0;
        transform: scale(0.95);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    /* Close Button */
    .modal-content button {
      position: absolute;
      top: 1.2rem;
      right: 1.5rem;
      background: none;
      border: none;
      font-size: 2.5rem;
      color: #ff4d4d;
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .modal-content button:hover {
      transform: scale(1.2);
    }

    /* Hidden state */
    .hidden {
      display: none;
    }


    /* --- Restart button ---*/

    /* Appears after end game */
    .restart-button {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: auto;
    }

    #restart-button {
      font-size: 3.5rem;
    }

    #restart-button:hover {
      cursor: pointer;
      transform: translateY(-10px);
      transition: 0.5s ease;
    }

    /* --- main, game board --- */

    /* Main board container styles */
    main {
      display: flex;
      align-items: center;
      justify-content: center;
      flex: 1; /* Take remaining vertical space */
    }
    
    /* Board holds rows vertically */
    .game-board {
      display: flex;
      flex-direction: column;
      max-width: 450px;
      width: min(70vw, 450px);
      gap: clamp(0.4rem, 1vw, 1rem);
      margin: auto;
    }

    /* Each row is a grid of 5 tiles */
    .row {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: clamp(0.4rem, 1vw, 1rem);
    }

    /* Individual tile style */
    .tile {
      aspect-ratio: 1 / 1; /* Make tile square */
      background-color: var(--color-tile);
      border: 2px solid var(--color-border);
      border-radius: 1rem;
      font-size: clamp(2rem, 6vw, 5rem);
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      text-transform: uppercase;
      user-select: none; /* Prevent text selection */
      transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
    }

    /* Tile color for correct letter and position */
    .tile.correct {
      background-color: var(--color-correct);
      border-color: var(--color-correct);
      color: white;
    }

    /* Tile color for correct letter wrong position */
    .tile.present {
      background-color: var(--color-wrong-spot);
      border-color: var(--color-wrong-spot);
      color: white;
    }

    /* Tile color for incorrect letter */
    .tile.absent {
      background-color: var(--color-incorrect);
      border-color: var(--color-incorrect);
      color: white;
    }
    
    /* Tile animation */
    @keyframes flip-tile {
      0% {
        transform: rotateY(0deg); /* Original position */
      }
      50% {
        transform: rotateY(90deg); /* Mid rotation */
        background-color: var(--color-tile);
        border-color: var(--color-border);
        color: transparent;
      }
      50.01% {
        /* To prevent flickering and allow class switching mid-flip */
        background-color: inherit;
        border-color: inherit;
      }
      100% {
        transform: rotateY(0deg); /* Original Position */
      }
    }

    .tile.correct,
    .tile.present,
    .tile.absent {
      animation: flip-tile 0.6s ease;
      backface-visibility: hidden;
      transform-style: preserve-3d;
    }

    /* --- Virtual Keyboard --- */

    /* Virtual keyboard container */
    .virtual-keyboard {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
      padding: 2rem 1rem;
      width: min(95vw, 700px);
      max-width: 700px;
      margin: auto;
      box-sizing: border-box;
    }

    /* Each keyboard row */
    .keyboard-row {
      display: flex;
      justify-content: center;
      gap: 1rem;
      width: 100%;
    }

    /* Individual key style */
    .key {
      background-color: var(--color-tile);
      color: var(--color-text);
      font-size: clamp(1rem, 3vw, 2.5rem); /* Responsive font size */
      font-weight: bold;
      padding: 0.6em 0.4em;
      border: none;
      border-radius: 0.6rem;
      cursor: pointer;
      text-transform: uppercase;
      flex: 1;
      min-width: 1.5rem;
      transition: background-color 0.2s ease;
      box-sizing: border-box;
    }

    /* Hover effect for keys */
    .key:hover {
      background-color: var(--color-border);
    }

    /* Larger keys for Enter and Backspace */
    .key-large {
      flex: 1.5;
    }

    /* Color to the keys */
    .key.correct {
      background-color: #538d4e;
      color: white;
    }

    .key.present {
      background-color: #b59f3b;
      color: white;
    }

    .key.absent {
      background-color: #3a3a3c;
      color: white;
    }

    /* --- Footer --- */
    footer {
      text-align: center;
      padding: 1.5rem;
      background-color: var(--color-tile);
    }

    footer a {
      color: var(--color-accent);
      cursor: pointer;
    }

    /* --- Stats --- */
    .stats-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 2rem;
      justify-content: center;
      align-items: flex-end;
      margin-top: 2rem;
    }

    .stat-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      background: rgba(255, 255, 255, 0.05);
      padding: 1.5rem 2rem;
      border-radius: 1rem;
      min-width: 100px;
    }

    .stat-value {
      font-size: 3rem;
      font-weight: bold;
      color: #fff;
    }

    .stat-label {
      font-size: 1.3rem;
      margin-top: 0.5rem;
      color: #ddd;
    }


    /* --- Media (responsiveness) --- */

    /* Responsiveness to mobile devices */
    @media (max-width: 600px) {
      body {
        min-height: 100dvh;
      }

      .game-board {
        width: clamp(250px, 80vw, 450px);
      }

      #restart-button {
        font-size: clamp(2.5rem, 7vw, 3.5rem);
      }

      footer {
        padding: clamp(0.5rem, 2vw, 1rem);
      }

      header {
        padding: clamp(1.5rem, 4vw, 2rem) clamp(1.5rem, 5vw, 3rem);
      }

      .left-buttons button,
      .right-buttons button {
        font-size: clamp(1.4rem, 5vw, 2rem);
        border: solid 2px #ccc;
      }

      .app-name {
        font-size: clamp(1.2rem, 4vw, 1.4rem);
      }

      .modal-content {
        font-size: clamp(1.6rem, 4vw, 2rem);
        min-height: 400px;
        min-width: 300px;
        max-width: 350px;
        max-height: 600px;
      }

      .modal-content button {
        font-size: clamp(2.5rem, 6vw, 3.5rem);
      }

      .virtual-keyboard {
        margin-bottom: 6rem;
      }
    }

    /* Applied when the device is horizontal */
    @media (max-width: 916px) and (max-height: 500px) and (orientation: landscape) {
      .tile {
        font-size: clamp(1.2rem, 3vw, 1.6rem);
      }

      .game-board {
        width: clamp(180px, 25vw, 300px);
        margin-top: 0;
      }

      header {
        padding: clamp(1rem, 4vw, 2rem) auto;
      }

      header .app-name {
        font-size: clamp(1.2rem, 4vw, 1.6rem);
      }

      .left-buttons button,
      .right-buttons button {
        font-size: clamp(1.4rem, 5vw, 2rem);
        border: solid 2px #ccc;
      }

      #restart-button {
        font-size: clamp(2rem, 6vw, 3rem);
      }

      .virtual-keyboard {
        width: clamp(200px, 70vw, 600px);
        margin: clamp(0.5rem, 2vw, 1rem) auto;
      }

      .modal-content {
        font-size: clamp(1.2rem, 3.5vw, 1.6rem);
        max-width: 350px;
        max-height: 500px;
      }

      .modal-content button {
        top: clamp(2rem, 5vw, 4.5rem);
        left: 90%;
        font-size: clamp(2.5rem, 5vw, 3.5rem);
      }
    }
  </style>
</head>

<body>
  <!-- Website Header -->
  <header>
    <div class="left-buttons">
      <button type="button" id="help" aria-label="Help">‚ùî</button>
      <button type="button" id="stats" aria-label="Stats">üìä</button>
    </div>
    
    <div class="app-name">
      <h1>LETRA</h1>
    </div>

    <div class="right-buttons">
      <!-- Toggle between light and dark mode -->
      <button type="button" id="theme" aria-label="Toggle between dark and light mode">üí°</button>
      <!-- Configuration button with dropdown menu list -->
      <button type="button" id="cfg" aria-label="Configurations">‚öôÔ∏è</button>
      <div class="config-dropdown hidden" id="config-dropdown">
        <ul>
          <li data-action="clearStats">Resetar estat√≠sticas</li>
          <li data-action="showAbout">Sobre o projeto</li>
          <li data-action="showTipsModal">Dicas para vencer</li>
          <li id="toggleDifficultyBtn" data-action="toggleDifficulty"></li>
          <li id="toggleLangBtn" data-action="toggleLang"></li>
        </ul>
      </div>
    </div>
  </header>
  
  <!-- Informative message below the header, triggered by JavaScript -->
  <div class="msgBox hidden" id="msgBox">essa palavra n√£o √© aceita</div>

  <!-- Modal container -->
  <div id="modal" class="modal hidden">
    <div class="modal-content" id="modal-content">
      <button onclick="closeModal()">‚úñÔ∏è</button>
      <div id="modal-body">
        <!-- Dinamic content will be inserted here -->
      </div>
    </div>
  </div>


  <div class="restart-button">
    <button id="restart-button" style="display: none;" onclick="location.reload()">üîÑ</button>
  </div>


  <!-- Main board area with rows for each guess attempt -->
  <main>

    <div class="game-board">
      <!-- Tiles will be generated here dynamically with js -->
    </div>
  </main>
 

  <!-- On-screen keyboard for input, will be generated here with js-->
  <div class="virtual-keyboard data-status"></div>


  <footer>
    <small>Personal learning project ‚Äî Developed by <a href="https://www.github.com/xyz-leo" target="_blank">xyz-leo</a></small>
  </footer>

  <script>
    // github.com/xyz-leo

    // Constants for board size
    const NUM_ROWS = 6;
    const NUM_COLS = 5;
    
    // Track if the game have been ended
    let gameOver = false;


    // Modal
    const modal = document.getElementById('modal');
    const modalContent = document.getElementById('modal-content');
    const modalBody = document.getElementById('modal-body');

    modal.addEventListener('click', (event) => {
      if (event.target === modal) {
        closeModal();
      }
    });

    // --- Header buttons ---

    // Help button
    const helpbtn = document.getElementById('help');

    helpbtn.addEventListener('click', () => {
      openModal(`<h2>Como Jogar LETRA</h2>
<p>Bem-vindo ao LETRA ‚Äî um jogo de adivinha√ß√£o de palavras, totalmente offline!<br><br><strong>Aten√ß√£o: no teclado virtual, a tecla ENTER "‚Üµ", para enviar as tentativas, est√° abaixo da letra "A".</strong></p><br>

<h3>Objetivo</h3>
<p>Adivinhe a palavra secreta em at√© 6 tentativas.</p>

<br><h3>Como Jogar</h3>
<ul>
  <li>Digite uma palavra de 5 letras usando o teclado virtual ou o teclado f√≠sico.</li>
  <li>Ap√≥s cada tentativa, as cores das letras ir√£o mudar para indicar:</li>
  <ul>
    <li><strong>Verde:</strong> letra correta e na posi√ß√£o certa.</li>
    <li><strong>Amarelo:</strong> letra correta, mas na posi√ß√£o errada.</li>
    <li><strong>Cinza:</strong> letra incorreta, n√£o est√° na palavra.</li>
  </ul>
  <li>Use essas dicas para ajustar suas pr√≥ximas tentativas.</li>
</ul>

<br><h3>Bot√µes</h3>
<ul>
  <li><strong>‚ùî Help:</strong> abre este tutorial.</li>
  <li><strong>üìä Stats:</strong> mostra suas estat√≠sticas de jogo.</li>
  <li><strong>üí° Tema:</strong> alterna entre modo claro e escuro.</li>
  <li><strong>‚öôÔ∏è Configura√ß√µes:</strong> ajustes do jogo.</li>
  <li><strong>üîÑ Reiniciar:</strong> reinicia o jogo atual.</li>
</ul>

<p>Divirta-se e boa sorte!</p>
`);
    })


    // Stats button
    const statsbtn = document.getElementById('stats');

    statsbtn.addEventListener('click', () => {
      openModal(`
        <h2 style="margin-bottom: 2rem;">Estat√≠sticas</h2>

        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-value">${getGamesPlayed()}</div>
            <div class="stat-label">Jogadas</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">${getCorrectWordsCount()}</div>
            <div class="stat-label">Vit√≥rias</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">${getLostGamesCount()}</div>
            <div class="stat-label">Derrotas</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">${getAttemptsCount()}</div>
            <div class="stat-label">Tentativas</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">${getWinRate().toFixed(2)}%</div>
            <div class="stat-label">Winrate</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">${getAvgAttemptsToWin().toFixed(2)}</div>
            <div class="stat-label">M√©dia Tentativas</div>
          </div>
        </div>
      `);
    })


    // Theme dark/light mode change
    const togglebtn = document.getElementById('theme');
    const body = document.body;

    // Apply the saved theme on page loading
    function applyTheme() {
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'dark') {
        body.classList.add('dark');
        body.classList.remove('light');
      } else if (savedTheme === 'light') {
        body.classList.add('light');
        body.classList.remove('dark');
      } else {
        // If nothing is saved, set dark as default
        body.classList.add('dark');
        body.classList.remove('light');
      }
    }
    applyTheme();

    togglebtn.addEventListener('click', () => {
      if (body.classList.contains('dark')) {
        body.classList.remove('dark');
        body.classList.add('light');
        localStorage.setItem('theme', 'light');
      } else {
        body.classList.remove('light');
        body.classList.add('dark');
        localStorage.setItem('theme', 'dark');
      }
    });
    

    // Configuration button
    const cfgbtn = document.getElementById('cfg');
    const cfgDropdown = document.getElementById('config-dropdown');
      
    cfgbtn.addEventListener('click', () => {
      cfgDropdown.classList.toggle('hidden');
    });

    document.addEventListener('click', (e) => {
      const clickedOutside = !cfgbtn.contains(e.target) && !cfgDropdown.contains(e.target);
      const clickedOnOption = e.target.closest('[data-action]'); // clicked in any menu item

      if (clickedOutside || clickedOnOption) {
        cfgDropdown.classList.add('hidden');
      }
    });

    // Event delegation to the dropdown menu list items
    cfgDropdown.addEventListener('click', (e) => {
      const action = e.target.dataset.action;

      switch (action) {
        case 'clearStats':
          if (confirm('Apagar estat√≠sticas?')) {
            clearStats();
          }
          break;

        case 'showAbout':
          openModal(`
<h2>LETRA</h2>
<p><strong>LETRA</strong> √© um jogo minimalista de adivinha√ß√£o de palavras de 5 letras, inspirado no site <a href="https://term.ooo/" target=_blank style="color: #3ecf8e;">term.ooo</a>. O jogador tem seis tentativas para descobrir a palavra secreta.</p><br>
<h2>Detalhes t√©cnicos</h2>
<p>A interface foi constru√≠da com <code>HTML</code>, <code>CSS</code> e <code>JavaScript</code> puros, sem uso de bibliotecas ou framework externos. Todo o projeto est√° contido em um √∫nico arquivo <code>.html</code>, o que permite que ele funcione completamente offline, sem necessidade de servidor ou instala√ß√£o. Essa abordagem refor√ßa a proposta de simplicidade e portabilidade.</p><br>
<h2>Meu objetivo</h2>
<p>O principal objetivo deste projeto foi criar algo divertido que tamb√©m servisse como exerc√≠cio pr√°tico para refinar minhas habilidades em programa√ß√£o front-end.</p><br>
<h2>Minha p√°gina no GitHub</h2>
<a href="https://github.com/xyz-leo" target=_blank style="color: #3ecf8e;">xyz-leo</a>
`);
          break;
        case 'showTipsModal':
          openModal(`
<h2>Dicas para Vencer</h2>
<p>Algumas estrat√©gias podem aumentar muito suas chances de acertar a palavra oculta em menos tentativas:</p>

<ul>
  <li><strong>1. Comece com uma palavra forte:</strong> Use palavras iniciais que contenham letras comuns da l√≠ngua portuguesa, como todas as vogais e consoantes <em style="color: #3ecf8e;">A, E, I, O, U, R, S, T, L...</em>. Exemplos: <code style="color: #3ecf8e;">IDEAL</code>, <code style="color: #3ecf8e">ACIDO</code>, <code style="color: #3ecf8e;">AUREO</code>.</li>

  <li><strong>2. Evite repetir letras no come√ßo:</strong> Tente usar 5 letras diferentes nas primeiras tentativas. Isso te ajuda a revelar mais op√ß√µes e eliminar letras rapidamente.</li>

  <li><strong>3. Elimine letras com l√≥gica:</strong> Se uma letra j√° apareceu como <span style="color:#444;">cinza</span> em v√°rias posi√ß√µes, evite us√°-la novamente.</li>

  <li><strong>4. Use palavras de teste:</strong> Se estiver em d√∫vida, insira uma palavra apenas para testar letras novas, mesmo que ache que n√£o √© a resposta final.</li>

  <li><strong>5. Jogue com calma:</strong> Pense antes de tentar. Use as pistas anteriores para guiar cada nova palavra. A pressa leva a erros!</li>
  
  <li><strong>6. Evite palavras inventadas:</strong> Para manter o jogo divertido e o desafio justo, evite digitar palavras aleat√≥rias ou inexistentes apenas para testar letras, j√° que este jogo n√£o faz a verifica√ß√£o no dicion√°rio.</li>
</ul>
`)
          break;

        case 'toggleDifficulty':
          // Toggle between easy and normal difficulty
          currentDifficulty = currentDifficulty === 'easy' ? 'normal' : 'easy';

          // Save the new difficulty to the localStorage
          localStorage.setItem('difficulty', currentDifficulty);

          // Update the difficulty text
          updateDifficultyLiText();

          // Updates the targetWord
          targetWord = getRandomWord(currentDifficulty, currentLang);

          // Informaive message
          showMessage(`Dificuldade alternou para: ${currentDifficulty}. A nova palavra foi selecionada!`, 5000);
          break;

        case 'toggleLang':
          // Toggle between brazilian portuguese or american english
          currentLang = currentLang === 'PtBr' ? 'EnUs' : 'PtBr';

          localStorage.setItem('lang', currentLang);

          updateLangLiText();

          targetWord = getRandomWord(currentDifficulty, currentLang);

          showMessage(`Idioma alterado para: ${currentLang}. Nova palavra selecionada!`);
          break;
        }
    });


    const wordsList = {
      PtBr: {
        "easy": [
          "amigo", "baile", "banco", "bicho", "botas", "brisa", "cabra",
          "carta", "casal", "caixa", "carro", "certo", "chave", "cinza", "claro", "clima", "cofre",
          "coisa", "cores", "cesta", "cinto", "campo", "dente", "dizer", "doido", "d√≥lar", "feira",
          "feliz", "ferro", "festa", "filho", "fotos", "folha", "forno", "fruta", "gente", "gosto",
          "jogar", "leite", "letra", "lim√£o", "limpo", "linha", "livro", "lugar", "limpo",
          "mam√£e", "macio", "meias", "meiga", "metro", "moeda", "morar", "mundo", "navio",
          "noite", "norte", "nobre", "nuvem", "nadar", "olhos", "papai", "pacto", "pasta", "piano",
          "ponto", "pular", "passe", "peixe", "pedra", "praia", "ponta", "risco", "risos", "roupa",
          "rodar", "salto", "salve", "sonho", "suave", "tempo", "terra", "toque", "treno", "troca",
          "tarde", "tocar", "troco", "velha", "venha", "vezes", "verde", "vento", "vapor", 
          "andar", "achar", "novas", "calma", "cerca", "manta", "renda"
        ],

        "normal": [
          "√°baco", "abade", "algor", "√¢mago", "√¢mbar", "andar", "√°pice", "arque", "baile",
          "bardo", "boato", "bolor", "banco", "calar", "carro", "casal", "certo", "chave", "c√≠vel", "cinto",
          "clima", "cofre", "coisa", "cosmo", "cores", "cruel", "dente", "d√©bil", "dique", "dizer", "doido",
          "dorso", "dueto", "√©gide", "√©brio", "enfim", "esgar", "√™xito", "√™xodo", "f√°tuo",
          "feliz", "fenda", "ferro", "festa", "filho", "forja", "forno", "fruir", "fotos", "folha",
          "fruta", "f√∫ria", "gente", "g√™nio", "g√≠ria", "glifo", "glosa", "gosto", "grato",
          "hoste", "√≠dolo", "√≠mpio", "√≠gneo", "√≠ndio", "√≠ntia", "irado", "jazem", "jejum",
          "jusso", "laudo", "leite", "letra", "lesma", "lim√£o", "limbo", "linha", "livro", "l√∫men",
          "macio", "manh√£", "manta", "matiz", "meiga", "meses", "metro", "meias", "m√≠dia", "misto",
          "moeda", "morar", "morro", "mundo", "nadar", "navio", "n√≠vel", "nobre", "noite", "norte",
          "nuvem", "ocaso", "odiar", "olhos", "√≥rf√£o", "ousar", "pacto", "p√°lio", "papai",
          "p√°ria", "passe", "pasta", "peixe", "pedra", "piano", "piche", "p√≥len", "ponto", "praia",
          "pular", "quark", "relho", "renda", "rodas", "reses", "r√©dea", "risco", "risos", "rodar", "rouca",
          "rufar", "salto", "salve", "sarca", "seita", "s√≠mio", "sonho", "sorna", "s√≥sia", "s√∫cia",
          "suave", "sulco", "tarde", "t√©dio", "tenaz", "tempo", "t√™nue", "terra", "toque", "torvo",
          "tocar", "tra√ßo", "treno", "trupe", "troca", "troco", "turvo", "√∫bere", "√∫mido",
          "vapor", "v√°rio", "velha", "venha", "veraz", "verde", "verbo", "vento", "vezes", "vinco",
          "vis√£o", "v√≠cio", "vulto", "abriu", "acaso", "acima", "acude", "adeus", "adult",
          "afiar", "agito", "agora", "alias", "aliar", "altar", "anelo", "anexo", "anoes", "antes",
          "antro", "apito", "apodo", "arado", "aroma", "artef", "atado", "atual", "aviso", "axial",
          "bazar", "beijo", "bento", "bicho", "bizar", "bloco", "bocal", "bossa", "botar", "brasa",
          "bravo", "breve", "brisa", "bruto", "bulbo", "burro", "cacho", "cacto", "caixa", "calma",
          "canso", "capaz", "capim", "carga", "carne", "casta", "ceder", "cegar", "chato", "choro",
          "civil", "claro", "clico", "cobre", "coito", "colhe", "comer", "conto", "copas", "coral",
          "corpo", "credo", "criar", "crise", "curto", "danar", "dan√ßa", "dardo", "desce", "disco",
          "dobro", "doces", "dogma", "dores", "dorme", "drama", "duelo", "eixos", "elite",
          "encar", "entra", "envio", "erram", "etapa", "etico", "evite", "exato",
          "exibe", "falha", "falso", "farol", "fatal", "fauno", "fazer", "feira", "feroz", "feudo",
          "ficar", "finta", "firma", "fixar", "fobia", "folga", "forca", "fosse", "fraco", "freio",
          "fundo", "ganho", "garra", "girar", "globo", "grave", "grota", "gueto", "harpa", "haste",
          "haver", "heroi", "horto", "humor", "ideal", "idoso", "igual", "ileso", "ilesa",
          "impar", "india", "inves", "jogar", "jovem", "julho", "junho", "junta", "lagoa", "lapso",
          "largo", "lebre", "leigo", "lenta", "lento", "lindo", "livre", "louro", "lutar", "macho",
          "magma", "magro", "manha", "mania", "manso", "marca", "massa", "matam", "medir", "meigo",
          "meios", "mesti", "mexer", "miudo", "morte", "mudar", "muito", "murro", "musgo",
          "nacao", "nariz", "natal", "negar", "neura", "nicho", "ninja", "notar", "obvia", "ofere",
          "olhar", "ontem", "opaco", "optar", "ordem", "ossos", "outra", "ouvir", "palco",
          "parou", "parte", "patas", "patio", "penal", "perco", "perto",
          "pisar", "plano", "pobre", "poder", "porco", "porre", "posto", "pouco", "preco", "preto",
          "prima", "prova", "pulga", "punha", "quase", "queda", "quero", "quilo", "ralar", "ran√ßo",
          "rapaz", "reage", "recem", "regar", "reino", "relax", "relva", "remar", "resto", "ritmo",
          "roubo", "saber", "sair√°", "salmo", "santo", "sarar", "sauna", "savio", "selar", "selva",
          "sinal", "sinta", "sobra", "sogro", "sorte", "subir", "sujar", "super", "surto", "sutil",
          "talha", "totem", "temer", "tenho", "texto", "tiara", "tirar", "tomar", "topar", "torna",
          "torre", "trago", "trama", "trapo", "treco", "trono", "turma", "uniao", "urgir", "vagar",
          "valer", "valha", "vazio", "vejam", "verme", "verso", "viola", "vista", "vital", "viver",
          "volta", "zebra", "zinco"
        ]
    },
      EnUs: {
        easy: [
          "apple", "bread", "chair", "dance", "drink", "earth", "field", "glass",
          "grape", "green", "happy", "house", "jelly", "juice", "light", "lunch",
          "mouse", "music", "night", "ocean", "paint", "phone", "plant", "queen",
          "quick", "river", "salad", "shirt", "short", "smile", "spoon", "table",
          "teach", "thank", "tiger", "train", "uncle", "watch", "white", "woman",
          "write", "zebra"
        ],

        normal: [
          "apple", "bread", "chair", "dance", "drink", "earth", "field", "glass",
          "grape", "green", "happy", "house", "jelly", "juice", "light", "lunch",
          "mouse", "music", "night", "ocean", "paint", "phone", "plant", "queen",
          "quick", "river", "salad", "shirt", "short", "smile", "spoon", "table",
          "teach", "thank", "tiger", "train", "uncle", "watch", "white", "woman",
          "write", "zebra",

          "adobe", "aloof", "blaze", "brawl", "brink", "clamp", "couch", "cynic",
          "dwarf", "eerie", "elbow", "evoke", "flair", "fluke", "gnome", "haste",
          "hatch", "idiom", "jolly", "latch", "linen", "lofty", "lunar", "medal",
          "mimic", "noble", "ounce", "pearl", "pivot", "plume", "realm", "scent",
          "shard", "skull", "sling", "slope", "snarl", "swoop", "throb", "vigor",
          "vivid", "waive", "whirl", "witty", "wrath", "yacht", "abide", "adorn", "aisle", "amber", "angry", "aptly", "arise", "arrow", "attic", "audio",
          "baker", "batch", "beach", "beast", "bingo", "bleak", "blend", "blink", "bliss", "bloom",
          "bluff", "bride", "brisk", "brood", "brush", "bulge", "bunch", "burly", "burnt", "burst",
          "cabin", "canal", "cargo", "carve", "chant", "charm", "chess", "chime", "choir", "chord",
          "clerk", "clone", "clown", "coast", "comet", "coral", "cover", "crate", "creed", "creek",
          "crown", "curvy", "daily", "dealt", "delay", "dense", "depth", "digit", "diver", "dizzy",
          "dodge", "donor", "doubt", "dough", "draft", "drain", "drift", "droll", "eagle", "elate",
          "ember", "entry", "equal", "equip", "erase", "ethic", "fable", "faint", "faith", "feast",
          "fever", "fiber", "fifty", "flame", "flare", "flock", "flute", "focus", "forge", "forth",
          "freed", "frost", "furry", "giant", "glide", "gloom", "grace", "grain", "grasp", "grief",
          "grind", "groan", "grove", "guile", "guilt", "habit", "harsh", "haste", "haunt", "hover",
          "hymns", "ideal", "infer", "inlet", "irony", "issue", "itchy", "ivory", "jelly", "jewel",
          "joint", "karma", "knack", "kneel", "knife", "knock", "label", "lance", "latch", "ledge",
          "lemon", "linen", "liver", "livid", "lobby", "loose", "lunar", "lurid", "lyric", "magic",
          "mango", "march", "marsh", "match", "mercy", "metal", "meter", "mirth", "mossy", "motto",
          "mural", "muted", "naive", "nerve", "niche", "ninth", "noble", "noisy", "notch", "novel",
          "nudge", "nylon", "oasis", "occur", "offer", "orbit", "organ", "oxide", "panel",
          "panic", "parka", "paste", "peach", "perch", "phase", "plead", "pluck", "plush", "poise",
          "porch", "prank", "press", "price", "prime", "prior", "prism", "proud", "punch", "quest",
          "quiet", "quota", "rabid", "radio", "ranch", "raven", "rebel", "reign", "renal", "rider",
          "ridge", "risky", "rival", "roast", "rough", "round", "ruler", "rusty", "saber", "saint",
          "salty", "sandy", "satin", "scale", "scent", "scout", "scrap", "sever", "shade", "shady",
          "shaft", "shaky", "shard", "shear", "sheep", "shell", "shiny", "shore", "shove", "shrew",
          "shrub", "sight", "siren", "skate", "skirt", "slack", "slant", "slope", "smack", "smear",
          "smoke", "snack", "snare", "sniff", "solar", "solid", "spade", "spare", "spark", "spear",
          "spice", "spike", "spine", "spite", "split", "spoil", "spray", "spurt", "squad",
          "squat", "squib", "stack", "stair", "stalk", "stare", "steam", "steed", "stern", "sting",
          "stomp", "stone", "storm", "strap", "stray", "strip", "stuck", "study", "sugar", "swamp",
          "swarm", "sweat", "sweet", "swept", "swing", "swoop", "sword", "table", "taint", "tally",
          "taper", "taste", "tempo", "tense", "thank", "theft", "theme", "thorn", "threw", "throb",
          "thrum", "thumb", "tiara", "tidal", "tiger", "timid", "title", "token", "torch", "tough",
          "toxin", "trace", "trail", "trait", "trash", "tread", "treat", "trend", "trial", "tribe",
          "trick", "tried", "troop", "troll", "trunk", "truth", "tulip", "twice", "twist", "uncle",
          "unity", "upper", "urban", "urged", "usage", "vague", "valid", "value", "vapor", "vault",
          "vivid", "vocal", "vouch", "wager", "waist", "waltz", "waste", "watch", "water", "weary",
          "wedge", "whale", "wheat", "whine", "whirl", "whisk", "white", "wider", "wield", "wiser",
          "witch", "witty", "woman", "woven", "wrack", "wrath", "wrist", "wrong", "xerox", "yacht",
          "yield", "young", "youth", "zebra", "zilch", "zonal"
        ]
      }
    };


    let currentDifficulty = localStorage.getItem('difficulty') || 'normal';
      
    let currentLang = localStorage.getItem('lang') || 'PtBr';

    let targetWord = getRandomWord(currentDifficulty, currentLang);


    function getRandomWord(currentDifficulty, currentLang) {
      const list = wordsList[currentLang][currentDifficulty];
      return list[Math.floor(Math.random() * list.length)].toUpperCase();
    }


    const toggleDifficultyBtn = document.getElementById('toggleDifficultyBtn');
    const toggleLangBtn = document.getElementById('toggleLangBtn');

    // Function to update the text of the button with the current difficulty
    function updateDifficultyLiText() {
      toggleDifficultyBtn.textContent = `Alternar dificuldade: ${currentDifficulty}`;
    }
updateDifficultyLiText();

    // Function to update the text of the button with the current language
    function updateLangLiText() {
      if (currentLang === 'PtBr') {
        toggleLangBtn.textContent = `Alternar idioma: Portugu√™s`;
      } else {
        toggleLangBtn.textContent = `Switch language: English`;
      }
    }
updateLangLiText();


    // -- Board --
    // Reference to board container
    const board = document.querySelector(".game-board");

    // Dynamically create rows and tiles for the game board
    for (let row = 0; row < NUM_ROWS; row++) {
      const rowElement = document.createElement("div");
      rowElement.classList.add("row");

      for (let col = 0; col < NUM_COLS; col++) {
        const tile = document.createElement("div");
        tile.classList.add("tile");
        tile.dataset.row = row;  // store row index
        tile.dataset.col = col;  // store column index
        rowElement.appendChild(tile);
      }

      board.appendChild(rowElement);
    }

    // Keyboard layout rows
    const keyboardLayout = [
      ["Q", "W", "E", "R", "T", "Y", "U", "I", "O", "P"],
      ["A", "S", "D", "F", "G", "H", "J", "K", "L"],
      ["‚Üµ", "Z", "X", "C", "V", "B", "N", "M", "üîô"]
    ];

    // Reference to virtual keyboard container
    const keyboard = document.querySelector(".virtual-keyboard");

    // Create buttons for each key in the layout
    keyboardLayout.forEach(row => {
      const rowDiv = document.createElement("div");
      rowDiv.classList.add("keyboard-row");

      row.forEach(key => {
        const keyButton = document.createElement("button");
        keyButton.textContent = key;
        keyButton.classList.add("key");
        // Larger keys for Enter (‚Üµ) and Backspace (üîô)
        if (key === "‚Üµ" || key === "üîô") {
          keyButton.classList.add("key-large");
        }
        keyButton.setAttribute("data-key", key);
        rowDiv.appendChild(keyButton);
      });

      keyboard.appendChild(rowDiv);
    });


    // Track current position on board
    let currentRow = 0;
    let currentCol = 0;

    // Store letters typed for current guess
    const currentGuess = [];

    // Allowed letters for input
    const LETTERS = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";

    // Listen for physical keyboard input
    document.addEventListener("keydown", (e) => {
      const key = e.key.toUpperCase();
      handleKey(key);
    });

    // Listen for clicks on virtual keyboard keys
    document.querySelector(".virtual-keyboard").addEventListener("click", (e) => {
      if (e.target.classList.contains("key")) {
        const key = e.target.textContent.toUpperCase();
        handleKey(key);
      }
    });

    // Handle key inputs from both physical and virtual keyboards
    function handleKey(key) {
      if (gameOver) return;

      if (key === "BACKSPACE" || key === "üîô") {
        deleteLetter();
      } else if (key === "ENTER" || key === "‚èé" || key === "‚Üµ") {
        submitGuess();
      } else if (LETTERS.includes(key) && currentCol < NUM_COLS) {
        insertLetter(key);
      }
    }


    // Insert letter into current tile and advance column
    function insertLetter(letter) {
      const tile = document.querySelector(
        `.tile[data-row="${currentRow}"][data-col="${currentCol}"]`
      );
      if (!tile) return;

      tile.textContent = letter;
      currentGuess.push(letter);
      currentCol++;
    }


    // Remove letter from current tile and move back column
    function deleteLetter() {
      if (currentCol === 0) return; // No letters to delete
      currentCol--;
      const tile = document.querySelector(
        `.tile[data-row="${currentRow}"][data-col="${currentCol}"]`
      );
      if (!tile) return;

      tile.textContent = "";
      currentGuess.pop();
    }


    // --- Modal ---
    function openModal(contentHTML) {
      modalBody.innerHTML = contentHTML;
      modal.classList.remove('hidden');
    }

    function closeModal() {
      modal.classList.add('hidden');
      modalBody.innerHTML = '';
    }


    // --- Restart button after the end of the game ---
    function showRestartButton() {
      const btn = document.getElementById("restart-button");
      if (btn) btn.style.display = "block";
    }

    // --- Helper function to remove accentuation ---
    function removeAccent(str) {
      return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
    }

    const letterUser = 'A'; // example, user typed A
    const letterTarget = '√É'; // example, original letter in the word

    // Consider the two letters equal
    if (removeAccent(letterUser.toUpperCase()) === removeAccent(letterTarget.toUpperCase())) {
    }


    // --- Submit the current guess for validation ---
    function submitGuess() {
      if (currentGuess.length !== NUM_COLS) return;

      const guess = currentGuess.join("");
      const tiles = document.querySelectorAll(`.tile[data-row="${currentRow}"]`);

      const targetLetters = targetWord.split("");
      const guessLetters = guess.split("");

      // First step: mark green letters (the correct ones)
      const result = Array(NUM_COLS).fill("absent"); // Can be: 'correct', 'present', 'absent'


      for (let i = 0; i < NUM_COLS; i++) {
        if (removeAccent(guessLetters[i].toUpperCase()) === removeAccent(targetLetters[i]?.toUpperCase())) {
          result[i] = "correct";
          targetLetters[i] = null; // Mark as used
        }
      }


      // Second step: mark yellow letters (letters in the secret word)
      for (let i = 0; i < NUM_COLS; i++) {
        if (result[i] === "correct") continue;
        
        const index = targetLetters.findIndex(
          (letter) => letter !== null &&
          removeAccent(letter.toUpperCase()) === removeAccent(guessLetters[i].toUpperCase())
        );

        if (index !== -1) {
          result[i] = "present";
          targetLetters[index] = null; // Mark as used
        }
      }


      // Apply CSS classes to the tiles
      for (let i = 0; i < NUM_COLS; i++) {
        const letter = guessLetters[i];
        const status = result[i];


        // Apply in the tile
        tiles[i].classList.add(status);

        if (status === "correct") {
          tiles[i].textContent = targetWord[i];
        }


        // Apply in the virtual keyboard
        const keyButton = document.querySelector(`.key[data-key="${letter}"]`);
        if (keyButton) {
          const oldClass = keyButton.dataset.status;

          // Priority: correct > present > absent
          const priority = { correct: 3, present: 2, absent: 1, undefined: 0 };
          if (priority[status] > priority[oldClass]) {
            keyButton.classList.remove("correct", "present", "absent");
            keyButton.classList.add(status);
            keyButton.dataset.status = status;
          }
        }
      }
          
        // Will increment games played on the first attempt
        if (currentRow === 0) {
          incrementGamesPlayed();
        }

        // Every attempt will be registered
        incrementAttemptsCount();

        // Check win
        if (guess === removeAccent(targetWord)) {
          showMessage('You win!', 10000)
          incrementCorrectWords(currentRow + 1);
          gameOver = true;
          showRestartButton();
          return;
        }

      // Move to next row for next guess
      currentRow++;
      currentCol = 0;
      currentGuess.length = 0;

      if (currentRow >= NUM_ROWS) {
        showMessage(`Game over! Palavra: ${targetWord}`, 10000)
        gameOver = true;
        incrementLostGames();
        showRestartButton();
      }
    }


    // --- STATS ---

    // Function to get the current statistics
    function getStats() {
      // Get the stats from the localstorage
      const statsStr = localStorage.getItem('gameStats');

      // If it does not exists, return 0
      if (!statsStr) {
        return {
          correctWords: 0,
          attemptsCount: 0,
          lostGames: 0,
          gamesPlayed: 0,
          totalAttemptsToWin: 0,
        };
      }
      return JSON.parse(statsStr);
    }

    function saveStats(stats) {
      localStorage.setItem('gameStats', JSON.stringify(stats));
    }


    // Total games winned by the player
    function getCorrectWordsCount() {
      return getStats().correctWords;
    }

    // Function to increment the counter if the player won
    function incrementCorrectWords(attemptsUsed) {
      const stats = getStats();
      stats.correctWords++;
      stats.totalAttemptsToWin = (stats.totalAttemptsToWin || 0) + attemptsUsed;
      saveStats(stats);
    }


    // Total attempts
    function getAttemptsCount() {
      return getStats().attemptsCount;
    }

    function incrementAttemptsCount() {
      const stats = getStats();
      stats.attemptsCount++;
      saveStats(stats);
    }


    // Total games played
    function getGamesPlayed() {
      return getStats().gamesPlayed;
    }

    function incrementGamesPlayed() {
      const stats = getStats();
      stats.gamesPlayed++;
      saveStats(stats);
    }


    // Lost games (game over)
    // Could be gamesPlayed - correctWords
    function getLostGamesCount() {
      return getStats().lostGames;
    }

    function incrementLostGames() {
      const stats = getStats();
      stats.lostGames++;
      saveStats(stats);
    }

    function incrementTotalAttemptsToWin(attemptsUsed) {
      const stats = getStats();
      stats.totalAttemptsToWin += attemptsUsed;
      saveStats(stats);
    }

    // Win rate - read only - separation of concerns
    function getWinRate() {
      const stats = getStats();
      if (stats.gamesPlayed === 0) return 0;
      return (stats.correctWords / stats.gamesPlayed) * 100;
    }

    // Average attempts to win - totalAttemptsToWin / correctWords
    function getAvgAttemptsToWin() {
      const stats = getStats();
      if (!stats.correctWords || stats.correctWords === 0) return 0;
      return stats.totalAttemptsToWin / stats.correctWords;
    }


    // Clear stats (option in the configuration button dropdown menu)
    function clearStats() {
      localStorage.removeItem('gameStats');
      location.reload();
    }


    // Message box with fade in/out
    function showMessage(text, duration = 3000) {
      const box = document.getElementById('msgBox');
      box.textContent = text;
      box.classList.remove('hidden');
      
      void box.offsetWidth;

      box.classList.add('show');

      setTimeout(() => {
        box.classList.remove('show');
        setTimeout(() => {
          box.classList.add('hidden');
        }, 600); // fade-out before hide
      }, duration);
    }
  </script>
</body>
<!-- github.com/xyz-leo -->
</html>
